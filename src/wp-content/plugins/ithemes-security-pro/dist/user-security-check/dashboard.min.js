this.itsec=this.itsec||{},this.itsec["user-security-check"]=this.itsec["user-security-check"]||{},this.itsec["user-security-check"].dashboard=(window.itsecWebpackJsonP=window.itsecWebpackJsonP||[]).push([[38],{"1ZqX":function(e,t){!function(){e.exports=this.wp.data}()},"5Kuv":function(e,t,c){},FqII:function(e,t){!function(){e.exports=this.wp.date}()},GRId:function(e,t){!function(){e.exports=this.wp.element}()},K9lf:function(e,t){!function(){e.exports=this.wp.compose}()},Mmq9:function(e,t){!function(){e.exports=this.wp.url}()},RxS6:function(e,t){!function(){e.exports=this.wp.keycodes}()},Tqx9:function(e,t){!function(){e.exports=this.wp.primitives}()},TvNi:function(e,t){!function(){e.exports=this.wp.plugins}()},YLtl:function(e,t){!function(){e.exports=this.lodash}()},cDcd:function(e,t){!function(){e.exports=this.React}()},elev:function(e,t,c){"use strict";c.r(t);var r=c("GRId"),s=c("l3Sj"),a=c("TvNi"),n=c("1ZqX"),i=c("ppSj"),l=c("YLtl"),o=c("TSYQ"),u=c.n(o),d=c("tI+e"),b=c("K9lf"),m=c("g56x"),O=c("wLpv"),h=c("gf1k"),f=c("49++"),p=c("FqII"),j=c("ywyh"),_=c.n(j),y=c("Td6G");function E(e){switch(e){case"enabled":return["yes",Object(s.__)("Enabled","it-l10n-ithemes-security-pro")];case"not-enabled":return["no-alt",Object(s.__)("Not Enabled","it-l10n-ithemes-security-pro")];case"not-available":return["no-alt",Object(s.__)("Module Inactive","it-l10n-ithemes-security-pro")];case"enforced-not-configured":return["minus",Object(s.__)("Enforced, Not Configured","it-l10n-ithemes-security-pro")];default:return["minus",e]}}function g(e){switch(e){case 0:case 1:return["short",Object(s._x)("Very Weak","password strength","it-l10n-ithemes-security-pro")];case 2:return["bad",Object(s._x)("Weak","password strength","it-l10n-ithemes-security-pro")];case 3:return["good",Object(s._x)("Medium","password strength","it-l10n-ithemes-security-pro")];case 4:return["strong",Object(s._x)("Strong","password strength","it-l10n-ithemes-security-pro")];default:return["unknown",Object(s._x)("Unknown","password strength","it-l10n-ithemes-security-pro")]}}function w(e,t){let c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{execute:s,status:a,value:n,error:o}=Object(i.a)(Object(r.useCallback)(c=>_()({url:null==e?void 0:e.href,method:Object(l.isArray)(null==e?void 0:e.methods)?null==e?void 0:e.methods[0]:null==e?void 0:e.methods,parse:!1,data:c}).then(e=>(null==t||t(e),y.b.fromResponse(e))).catch(async e=>function(e){throw e}(await y.b.fromResponse(e))),[e]),c);return v(a,n,o),{execute:s,status:a,value:n,error:o}}function v(e,t,c){const{createNotice:a,removeNotice:i}=Object(n.useDispatch)("core/notices"),o=(e,t)=>{const c=Object(l.uniqueId)("security-profile-action");a(e,t,{context:"ithemes-security",id:c}),setTimeout(()=>i(c,"ithemes-security"),5e3)};Object(r.useEffect)(()=>{if("error"===e){const e=Object(y.o)(c.error).join(" ");a("error",e||Object(s.__)("An unknown error occurred.","it-l10n-ithemes-security-pro"),{context:"ithemes-security"})}else"success"===e&&(t.success.length>0&&o("success",t.success.join(" ")),t.info.length>0&&o("info",t.info.join(" ")),t.warning.length>0&&o("warning",t.warning.join(" ")))},[e,t,c])}function N(e){let{card:t,user:c}=e;return Object(r.createElement)("section",{className:"itsec-card-security-profile__user-info"},Object(r.createElement)("table",null,Object(r.createElement)("tbody",null,Object(r.createElement)("tr",null,Object(r.createElement)("th",null,Object(s.__)("Role","it-l10n-ithemes-security-pro")),Object(r.createElement)("td",null,c.role)),Object(r.createElement)("tr",null,Object(r.createElement)("th",null,Object(s.__)("Password Strength","it-l10n-ithemes-security-pro")),Object(r.createElement)("td",null,Object(r.createElement)("span",{className:u()("itsec-card-security-profile__password-strength","itsec-card-security-profile__password-strength--"+g(c.password_strength)[0])},g(c.password_strength)[1]))),c.password_last_changed&&Object(r.createElement)("tr",null,Object(r.createElement)("th",null,Object(s.__)("Password Age","it-l10n-ithemes-security-pro")),Object(r.createElement)("td",null,Object(r.createElement)("span",{title:Object(p.dateI18n)("M d, Y g:s A",c.password_last_changed.time)},c.password_last_changed.diff))),Object(r.createElement)("tr",null,Object(r.createElement)("th",null,Object(s.__)("Two-Factor","it-l10n-ithemes-security-pro")),Object(r.createElement)("td",null,E(c.two_factor)[1])),c.last_active&&Object(r.createElement)("tr",null,Object(r.createElement)("th",null,Object(s.__)("Last Seen","it-l10n-ithemes-security-pro")),Object(r.createElement)("td",null,Object(r.createElement)("span",{title:Object(p.dateI18n)("M d, Y g:s A",c.last_active.time)},c.last_active.diff))))),Object(r.createElement)(x,{card:t,user:c}))}function x(e){let{card:t,user:c}=e;return Object(r.createElement)("div",{className:"itsec-card-security-profile__user-actions"},Object(r.createElement)(I,{card:t,user:c}),Object(r.createElement)(L,{card:t,user:c}))}function I(e){var t,c,a;let{card:n,user:l}=e;const o=null===(t=n._links)||void 0===t||null===(c=t["ithemes-security:send-2fa-reminder"])||void 0===c||null===(a=c[0])||void 0===a?void 0:a.href,{execute:u,status:b,value:m,error:O}=Object(i.a)(Object(r.useCallback)(()=>_()({url:o.replace("{user_id}",l.id),parse:!1,method:"POST"}).then(y.b.fromResponse).catch(async e=>function(e){throw e}(await y.b.fromResponse(e)))),!1);return v(b,m,O),!o||"enforced-not-configured"!==l.two_factor&&"not-enabled"!==l.two_factor?null:Object(r.createElement)(d.Button,{isSmall:!0,isPrimary:!0,isBusy:"pending"===b,onClick:u},Object(s.__)("Send Two-Factor Reminder","it-l10n-ithemes-security-pro"))}function L(e){var t,c,a;let{card:n,user:l}=e;const o=null===(t=n._links)||void 0===t||null===(c=t["ithemes-security:logout"])||void 0===c||null===(a=c[0])||void 0===a?void 0:a.href,{execute:u,status:b,value:m,error:O}=Object(i.a)(Object(r.useCallback)(()=>_()({url:o.replace("{user_id}",l.id),parse:!1,method:"POST"}).then(y.b.fromResponse).catch(async e=>function(e){throw e}(await y.b.fromResponse(e)))),!1);return v(b,m,O),o?Object(r.createElement)(d.Button,{isSmall:!0,isSecondary:!0,isBusy:"pending"===b,onClick:u},Object(s.__)("Force Logout","it-l10n-ithemes-security-pro")):null}function k(e){let{master:t}=e;return Object(r.createElement)(React.Fragment,null,Object(r.createElement)("td",{className:"itsec-card-security-profile__users--column-avatar"},Object(r.createElement)("img",{src:t.avatar,alt:""})),Object(r.createElement)("th",{scope:"row",className:"itsec-card-security-profile__users--column-username"},t.name),Object(r.createElement)("td",{className:"itsec-card-security-profile__users--column-role"},t.role),Object(r.createElement)("td",{className:"itsec-card-security-profile__users--column-two-factor"},Object(r.createElement)(d.Dashicon,{icon:E(t.two_factor)[0]}),Object(r.createElement)("span",{className:"screen-reader-text"},E(t.two_factor)[1])))}function C(e){let{master:t,pinUser:c,profileCards:a,card:n}=e;return Object(r.createElement)("section",{className:"itsec-card-security-profile__user"},Object(r.createElement)("header",{className:"itsec-card-security-profile__user-header"},Object(r.createElement)("img",{src:t.avatar,alt:""}),Object(r.createElement)("h3",null,t.name),!a.includes(t.id)&&Object(r.createElement)(d.Button,{isLink:!0,onClick:()=>c(t.id)},Object(s.__)("Pin","it-l10n-ithemes-security-pro"))),Object(r.createElement)(N,{user:t,card:n}))}function S(e){var t;let{context:c}=e;const a=Object(b.useInstanceId)(S,"itsec-card-security-profile__filter-roles"),{roles:i,config:o,isQuerying:m}=Object(n.useSelect)(e=>({roles:e("ithemes-security/core").getRoles(),config:e("ithemes-security/dashboard").getAvailableCard(c.card),isQuerying:e("ithemes-security/dashboard").isQueryingDashboardCard(c.id)}),[c.id,c.card]),{queryDashboardCard:h}=Object(n.useDispatch)("ithemes-security/dashboard"),p=Object(r.useCallback)((e,t)=>{h(c.id,{search:e,roles:t})},[c.id]),j=Object(b.useDebounce)(p,300),[_,y]=Object(r.useState)(""),[E,g]=Object(r.useState)(!1),[w,v]=Object(r.useState)((null===(t=o.query_args.roles)||void 0===t?void 0:t.default)||[]);return Object(r.useEffect)(()=>j(_,w),[_,w]),Object(r.createElement)("div",{className:u()("itsec-card-security-profile__filter",{"itsec-card-security-profile__filter--roles-visible":E,"itsec-card-security-profile__filter--has-roles":o.query_args.roles})},Object(r.createElement)("div",{className:"itsec-card-security-profile__filter-search"},Object(r.createElement)(O.i,{value:_,onChange:y,label:Object(s.__)("Search Users","it-l10n-ithemes-security-pro"),placeholder:Object(s.__)("Search Users"),isSearching:m,surfaceVariant:"secondary"})),o.query_args.roles&&Object(r.createElement)(d.Button,{icon:"filter",onClick:()=>g(!E),"aria-expanded":E,"aria-controls":a},Object(s.sprintf)(Object(s.__)("Roles (%d)","it-l10n-ithemes-security-pro"),w.length)),E&&Object(r.createElement)("ul",{id:a},Object(l.map)(i,(e,t)=>Object(r.createElement)("li",{key:t},Object(r.createElement)(f.f,{label:e.label,checked:w.includes(t),onChange:e=>v(e?[...w,t]:Object(l.without)(w,t))})))))}function D(e){var t,c,s,a;let{context:i}=e;const{refreshDashboardCard:l}=Object(n.useDispatch)("ithemes-security/dashboard"),o=null===(t=i._links)||void 0===t||null===(c=t["ithemes-security:force-password-change"])||void 0===c?void 0:c[0],u=null===(s=i._links)||void 0===s||null===(a=s["ithemes-security:clear-password-change"])||void 0===a?void 0:a[0],{execute:d,status:b}=w(o,()=>l(i.id),!1),{execute:m,status:O}=w(u,()=>l(i.id),!1);return o?Object(r.createElement)("footer",{className:"itsec-card-security-profile__footer"},Object(r.createElement)(f.x,{isSmall:!0,isPrimary:!0,isBusy:"pending"===b||"pending"===O,text:o.title,onClick:()=>d(),controls:[u&&{title:u.title,onClick(){m()}}]})):null}const R={render:Object(b.compose)([b.withInstanceId,Object(n.withDispatch)((e,t)=>({pinUser(c){e("ithemes-security/dashboard").saveDashboardCard(t.dashboardId,{card:"security-profile",settings:{user:c}})}})),Object(n.withSelect)((e,t)=>({profileCards:e("ithemes-security/dashboard").getDashboardCards(t.dashboardId).filter(e=>"security-profile"===e.card).map(e=>Object(l.get)(e,["data","user","id"]))}))])((function(e){let{card:t,config:c,eqProps:a,profileCards:n,pinUser:l}=e;const[o,u]=Object(r.useState)(0),d=Object(i.l)({pinUser:l,profileCards:n,card:t})(C),b=e=>u(e),m=a["max-width"]&&a["max-width"].includes("500px");return Object(r.createElement)("div",{className:"itsec-card--type-security-profile-list"},Object(r.createElement)(h.CardHeader,null,Object(r.createElement)(h.MasterDetailBack,{isSmall:m,select:b,selectedId:o}),Object(r.createElement)(h.CardHeaderTitle,{card:t,config:c}),Object(r.createElement)(h.CardHeaderStatus,null)),Object(r.createElement)(h.MasterDetail,{masters:t.data.users,detailRender:d,masterRender:k,ListHeader:S,ListFooter:D,selectedId:o,select:b,isSmall:m,context:t},Object(r.createElement)("thead",null,Object(r.createElement)("tr",null,Object(r.createElement)("th",{className:"itsec-card-security-profile__users--column-avatar"},Object(r.createElement)("span",{className:"screen-reader-text"},Object(s.__)("Avatar","it-l10n-ithemes-security-pro"))),Object(r.createElement)("th",{className:"itsec-card-security-profile__users--column-username"},Object(s.__)("Username","it-l10n-ithemes-security-pro")),Object(r.createElement)("th",{className:"itsec-card-security-profile__users--column-role"},Object(s.__)("Role","it-l10n-ithemes-security-pro")),Object(r.createElement)("th",{className:"itsec-card-security-profile__users--column-two-factor"},Object(s.__)("2FA","it-l10n-ithemes-security-pro"))))))})),elementQueries:[{type:"width",dir:"max",px:500},{type:"width",dir:"min",px:501},{type:"width",dir:"max",px:700}]};Object(m.addFilter)("ithemes-security.dashboard.getCardTitle.security-profile","ithemes-security/security-profile/default",(function(e,t){return t.data.user&&t.data.user.name?Object(s.sprintf)(Object(s.__)("Security Profile – %s","it-l10n-ithemes-security-pro"),t.data.user.name):t.settings&&t.settings.user?Object(s.sprintf)(Object(s.__)("User (%d) Security Profile","it-l10n-ithemes-security-pro"),t.settings.user):e}));var P=c("Mmq9");const q=e=>new Promise((t,c)=>{_()({path:Object(P.addQueryArgs)("/wp/v2/users",{search:e,per_page:100,itsec_global:!0})}).then(e=>t(e.map(e=>({value:e.id,label:e.name})))).catch(c)});var T=Object(b.compose)([Object(n.withDispatch)((e,t)=>({unPin:()=>e("ithemes-security/dashboard").removeDashboardCard(t.dashboardId,t.card),save:c=>e("ithemes-security/dashboard").saveDashboardCard(t.dashboardId,c)}))])((function(e){let{card:t,save:c}=e;const[a,n]=Object(r.useState)(0);return Object(r.createElement)("section",{className:"itsec-card-security-profile__select-user"},Object(r.createElement)("label",{htmlFor:"itsec-card-security-profile__select-user-dropdown--"+t.id},Object(s.__)("Select a User","it-l10n-ithemes-security-pro")),Object(r.createElement)("form",{className:"itsec-card-security-profile__select-form"},Object(r.createElement)(f.c,{addErrorBoundary:!1,className:"itsec-card-security-profile__select-user-dropdown",classNamePrefix:"itsec-card-security-profile__select-user-dropdown",inputId:"itsec-card-security-profile__select-user-dropdown--"+t.id,cacheOptions:!0,defaultOptions:!0,loadOptions:q,value:a,onChange:e=>n(e),maxMenuHeight:150}),Object(r.createElement)("div",{className:"itsec-card-security-profile__select-user-save-container"},Object(r.createElement)(d.Button,{onClick:()=>c({...t,settings:{...t.settings||{},user:a.value}})},Object(s.__)("Select","it-l10n-ithemes-security-pro")))),Object(r.createElement)("p",{className:"description"},Object(s.__)("Select a user to monitor with this card.","it-l10n-ithemes-security-pro")))}));c("5Kuv");const F={render:Object(b.compose)([Object(n.withSelect)((e,t)=>({canEdit:e("ithemes-security/dashboard").canEditCard(t.dashboardId,t.card.id)}))])((function(e){let{card:t,config:c,canEdit:s,dashboardId:a}=e;const n=t.data.user;return Object(r.createElement)("div",{className:"itsec-card--type-security-profile"},n&&Object(r.createElement)("section",{className:"itsec-card-security-profile__user"},Object(r.createElement)("header",{className:"itsec-card-security-profile__user-header itsec-card__drag-handle"},Object(r.createElement)("img",{src:n.avatar,alt:""}),Object(r.createElement)("h3",null,n.name)),Object(r.createElement)(N,{user:n,card:t})),!n&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(h.CardHeader,null,Object(r.createElement)(h.CardHeaderTitle,{card:t,config:c})),s&&Object(r.createElement)(T,{card:t,dashboardId:a})))})),elementQueries:[{type:"width",dir:"max",px:250}]};function B(){const{registerCard:e}=Object(n.useDispatch)("ithemes-security/dashboard");return Object(i.g)(B,()=>{e("security-profile-list",R),e("security-profile",F)}),null}c.p=window.itsecWebpackPublicPath,Object(s.setLocaleData)({"":{}},"ithemes-security-pro"),Object(a.registerPlugin)("itsec-user-security-check-dashboard",{render:()=>Object(r.createElement)(B,null)})},faye:function(e,t){!function(){e.exports=this.ReactDOM}()},g56x:function(e,t){!function(){e.exports=this.wp.hooks}()},gf1k:function(e,t){!function(){e.exports=this.itsec.dashboard.dashboard}()},l3Sj:function(e,t){!function(){e.exports=this.wp.i18n}()},rl8x:function(e,t){!function(){e.exports=this.wp.isShallowEqual}()},"tI+e":function(e,t){!function(){e.exports=this.wp.components}()},ywyh:function(e,t){!function(){e.exports=this.wp.apiFetch}()},z1rk:function(e,t){!function(){e.exports=this.itsec.packages.data}()}},[["elev",0,4,1,2,3]]]);