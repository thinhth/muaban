this.itsec=this.itsec||{},this.itsec["pro-dashboard"]=this.itsec["pro-dashboard"]||{},this.itsec["pro-dashboard"].dashboard=(window.itsecWebpackJsonP=window.itsecWebpackJsonP||[]).push([[32],{"1ZqX":function(e,t){!function(){e.exports=this.wp.data}()},FqII:function(e,t){!function(){e.exports=this.wp.date}()},GRId:function(e,t){!function(){e.exports=this.wp.element}()},K9lf:function(e,t){!function(){e.exports=this.wp.compose}()},Mmq9:function(e,t){!function(){e.exports=this.wp.url}()},RxS6:function(e,t){!function(){e.exports=this.wp.keycodes}()},Tqx9:function(e,t){!function(){e.exports=this.wp.primitives}()},TvNi:function(e,t){!function(){e.exports=this.wp.plugins}()},Wv0H:function(e,t,a){"use strict";a.r(t);var s=a("GRId"),r=a("TvNi"),c=a("l3Sj"),n=a("1ZqX"),i=a("rmEH"),d=a("tI+e"),o=a("cruf"),l=a("YLtl"),b=a("gf1k"),h=a("K9lf");var u=Object(h.compose)([Object(n.withSelect)((e,t)=>({dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t.dashboardId)})),Object(n.withDispatch)((e,t)=>({remove(){const a=[];for(const e of t.dashboard.sharing)if("user"!==e.type)a.push(e);else if(e.users.includes(t.userId)){const s={...e,users:e.users.filter(e=>e!==t.userId)};a.push(s)}else a.push(e);return e("ithemes-security/dashboard").saveDashboard({...t.dashboard,sharing:a})}}))])((function(e){let{userId:t,user:a,remove:r}=e;const n=a?a.name:Object(c.sprintf)(Object(c.__)("User #%d","it-l10n-ithemes-security-pro"),t),i=Object(b.getAvatarUrl)(a);return Object(s.createElement)(d.Dropdown,{className:"itsec-admin-bar-share__recipient itsec-admin-bar-share__recipient--user",contentClassName:"itsec-admin-bar-share__recipient-content itsec-admin-bar-share__recipient-content--user",headerTitle:Object(c.sprintf)(Object(c.__)("Share Settings for %s","it-l10n-ithemes-security-pro"),n),focusOnMount:"container",expandOnMobile:!0,renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return Object(s.createElement)(d.Tooltip,{text:n},Object(s.createElement)(d.Button,{"aria-pressed":t,"aria-label":n,onClick:a,className:"itsec-admin-bar-share__recipient-trigger",style:{backgroundImage:`url(${i})`}}))},renderContent:()=>Object(s.createElement)(s.Fragment,null,Object(s.createElement)("header",null,Object(s.createElement)("img",{src:i,alt:""}),Object(s.createElement)("h3",null,n)),Object(s.createElement)("footer",null,Object(s.createElement)(d.Button,{isLink:!0,onClick:r},Object(c.__)("Remove","it-l10n-ithemes-security-pro"))))})})),m=a("oSrf"),O=a.n(m),j=a("TXkB");function p(e){let{dashboardId:t,role:a}=e;const{dashboard:r,roles:i}=Object(n.useSelect)(e=>({dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t),roles:e("ithemes-security/core").getRoles()}),[t]),{saveDashboard:o}=Object(n.useDispatch)("ithemes-security/dashboard"),b=()=>{const e=[];for(const t of r.sharing)if("role"!==t.type)e.push(t);else if(t.roles.includes(a)){const s={...t,roles:t.roles.filter(e=>e!==a)};e.push(s)}else e.push(t);return o({...r,sharing:e})},h=Object(l.get)(i,[a,"label"],a),u=h.split(" ");let m;m=1===u.length?h.substring(0,2):u[0].substring(0,1).toUpperCase()+u[1].substring(0,1).toUpperCase();const p=j.i[(e=>{let t=0;for(let a=0;a<e.length;a++)t+=e.charCodeAt(a);return t})(a)%j.i.length];return Object(s.createElement)(d.Dropdown,{className:"itsec-admin-bar-share__recipient itsec-admin-bar-share__recipient--role",contentClassName:"itsec-admin-bar-share__recipient-content itsec-admin-bar-share__recipient-content--role",headerTitle:Object(c.sprintf)(Object(c.__)("Share Settings for %s","it-l10n-ithemes-security-pro"),h),focusOnMount:"container",expandOnMobile:!0,renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return Object(s.createElement)(d.Tooltip,{text:h},Object(s.createElement)(d.Button,{"aria-pressed":t,onClick:a,className:"itsec-admin-bar-share__recipient-trigger","aria-label":h,style:{backgroundColor:p}},Object(s.createElement)("span",{className:"itsec-admin-bar-share__role-abbr itsec-admin-bar-share__role-abbr--theme-"+O()(p)},m)))},renderContent:()=>Object(s.createElement)(s.Fragment,null,Object(s.createElement)("header",null,Object(s.createElement)("h3",null,h)),Object(s.createElement)("footer",null,Object(s.createElement)(d.Button,{isLink:!0,onClick:b},Object(c.__)("Remove","it-l10n-ithemes-security-pro"))))})}var _=a("49++"),g=a("4eJC"),f=a.n(g),E=a("ywyh"),y=a.n(E),N=a("Mmq9");const I=f()((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>new Promise((a,s)=>{y()({path:Object(N.addQueryArgs)("/wp/v2/users",{search:t,per_page:100,exclude:e})}).then(e=>a(e.map(e=>({value:e.id,label:e.name,user:e})))).catch(s)})})),v=Object(h.compose)([Object(n.withSelect)((e,t)=>({user:e("ithemes-security/dashboard").getUser(t.userId)}))])(e=>{let{user:t}=e;return Object(s.createElement)("li",null,t.name)}),D=f()((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(...e.map(e=>e.users||[]))}));var w=Object(h.compose)([Object(n.withSelect)((e,t)=>({suggested:e("ithemes-security/dashboard").getSuggestedShareUsers(),dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t.dashboardId)})),Object(n.withDispatch)(e=>({receiveUser:e("ithemes-security/dashboard").receiveUser}))])((function(e){let{suggested:t,dashboard:a,share:r={type:"user",users:[]},onChange:n,receiveUser:i}=e;const[o,l]=Object(s.useState)(void 0),[b,h]=Object(s.useState)(""),u=D(a.sharing).concat(a.created_by),m=t.filter(e=>!u.includes(e.id));return Object(s.createElement)(s.Fragment,null,m.length>0&&Object(s.createElement)("fieldset",{className:"itsec-share-dashboard__suggested-users"},Object(s.createElement)("legend",null,Object(c.__)("Suggested Users","it-l10n-ithemes-security-pro")),Object(s.createElement)("ul",null,m.map(e=>Object(s.createElement)("li",{key:e.id},Object(s.createElement)(d.CheckboxControl,{label:e.name,checked:r.users.includes(e.id),onChange:t=>n(t?{...r,users:[...r.users,e.id]}:{...r,users:r.users.filter(t=>t!==e.id)})}))))),Object(s.createElement)("fieldset",{className:"itsec-share-dashboard__add-users"},Object(s.createElement)("legend",null,Object(c.__)("All Users","it-l10n-ithemes-security-pro")),Object(s.createElement)("ul",null,r.users.filter(e=>!t.some(t=>t.id===e)).map(e=>Object(s.createElement)(v,{key:e,userId:e}))),Object(s.createElement)("label",{className:"itsec-share-dashboard__add-users-select",htmlFor:"itsec-share-dashboard__add-users-select"},Object(c.__)("Select a User","it-l10n-ithemes-security-pro")),Object(s.createElement)("div",{className:"itsec-share-dashboard__add-users-fields"},Object(s.createElement)(_.c,{className:"itsec-share-dashboard__add-users-select-dropdown",inputId:"itsec-share-dashboard__add-users-select",cacheOptions:!0,defaultOptions:!0,loadOptions:I(u),value:o,onChange:e=>l(e),inputValue:b,onInputChange:e=>h(e),maxMenuHeight:150,menuPlacement:"top"}),Object(s.createElement)("div",{className:"itsec-share-dashboard__add-users-trigger"},Object(s.createElement)(d.Button,{onClick:e=>{e.preventDefault(),o&&(i(o.user),n({...r,users:[...r.users,o.value]}),l(!1),h(""))},disabled:!o},Object(c.__)("Select","it-l10n-ithemes-security-pro"))))))}));const C=f()((e,t)=>e.some(e=>"role"===e.type&&e.roles.includes(t)));function S(e){let{dashboardId:t,share:a={type:"role",roles:[]},onChange:r}=e;const{dashboard:i,roles:o}=Object(n.useSelect)(e=>({dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t),roles:e("ithemes-security/core").getRoles()}),[t]),b=Object(l.pickBy)(o,(e,t)=>!C(i.sharing,t));return Object(l.isEmpty)(b)?Object(s.createElement)("p",null,Object(c.__)("All roles already selected.","it-l10n-ithemes-security-pro")):Object(s.createElement)("ul",null,Object(l.map)(b,(e,t)=>Object(s.createElement)("li",{key:t},Object(s.createElement)(d.CheckboxControl,{label:e.label,checked:a.roles.includes(t),onChange:e=>r(e?{...a,roles:[...a.roles,t]}:{...a,roles:a.roles.filter(e=>t!==e)})}))))}a("pyQa");const k=Object(l.once)(()=>[{name:"user",title:Object(c.__)("Users","it-l10n-ithemes-security-pro"),Component:w,type:"button",count:e=>Object(c.sprintf)(Object(c._n)("%d user","%d users",e.users.length,"it-l10n-ithemes-security-pro"),e.users.length)},{name:"role",title:Object(c.__)("Roles","it-l10n-ithemes-security-pro"),type:"button",Component:S,count:e=>Object(c.sprintf)(Object(c._n)("%d role","%d roles",e.roles.length,"it-l10n-ithemes-security-pro"),e.roles.length)}]);function L(e){let{dashboardId:t,close:a}=e;const[r,i]=Object(s.useState)({}),{isSaving:o,dashboard:b}=Object(n.useSelect)(e=>({isSaving:e("ithemes-security/dashboard").isSavingDashboard(t),dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t)}),[t]),{saveDashboard:h}=Object(n.useDispatch)("ithemes-security/dashboard"),u=k(),m=u.reduce((e,t)=>(r[t.name]&&e.push(t.count(r[t.name])),e),[]);return Object(s.createElement)("form",{className:"itsec-share-dashboard-add",onSubmit:e=>e.preventDefault()},Object(s.createElement)("header",{className:"itsec-share-dashboard-add__header"},Object(s.createElement)("h3",null,Object(c.__)("Share Dashboard","it-l10n-ithemes-security-pro")),Object(s.createElement)("p",null,Object(c.__)("Give select users read-only access to this dashboard. Great for building client portals.","it-l10n-ithemes-security-pro"))),Object(s.createElement)(_.y,{className:"itsec-share-dashboard-add__tab-panel",tabs:u,isStyled:!0},e=>{let{name:a,Component:c=l.noop}=e;return Object(s.createElement)(c,{dashboardId:t,share:r[a],onChange:e=>i({...r,[a]:e})})}),Object(s.createElement)("footer",{className:"itsec-share-dashboard-add__footer"},m.length>0&&Object(s.createElement)("span",{className:"itsec-share-dashboard-add__summary"},Object(c.sprintf)(Object(c.__)("%s selected","it-l10n-ithemes-security-pro"),m.join(", "))),Object(s.createElement)(d.Button,{isPrimary:!0,type:"submit",onClick:async e=>{e.preventDefault(),o||(await h({...b,sharing:[...b.sharing,...Object.values(r).filter(e=>e)]}),i({}),a())},isBusy:o,"aria-disabled":o},Object(c.__)("Share","it-l10n-ithemes-security-pro"))))}function x(e){let{dashboardId:t}=e;const{dashboard:a}=Object(n.useSelect)(e=>({dashboard:e("ithemes-security/dashboard").getDashboardForEdit(t)}),[t]),r=Object(l.get)(a,["_embedded","author",0]);return Object(s.createElement)("div",{className:"itsec-admin-bar__share"},r&&Object(s.createElement)("div",{className:"itsec-admin-bar-share__owner"},Object(s.createElement)(d.Tooltip,{text:r.name},Object(s.createElement)("span",{className:"itsec-admin-bar-share__recipient"},Object(s.createElement)("img",{className:"itsec-admin-bar-share__user-avatar",src:Object(b.getAvatarUrl)(r),alt:""})))),Object(s.createElement)("div",{className:"itsec-admin-bar-share__recipients"},Object(l.get)(a,"sharing",[]).filter(e=>"user"===e.type).map(e=>e.users.map(r=>{return Object(s.createElement)(u,{share:e,userId:r,user:(c=r,Object(l.find)(Object(l.get)(a,["_embedded","ithemes-security:shared-with"],[]),{id:c})),dashboardId:t,key:r});var c})),Object(l.get)(a,"sharing",[]).filter(e=>"role"===e.type).map(e=>e.roles.map(a=>Object(s.createElement)(p,{share:e,role:a,dashboardId:t,key:a})))),Object(s.createElement)("div",{className:"itsec-admin-bar-share__add-share-container"},Object(s.createElement)(d.Dropdown,{className:"itsec-admin-bar-share__add-share",contentClassName:"itsec-admin-bar-share__add-share-content",position:"bottom",expandOnMobile:!0,focusOnMount:"container",headerTitle:Object(c.__)("Share with User","it-l10n-ithemes-security-pro"),renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return Object(s.createElement)(d.Button,{label:Object(c.__)("Share Dashboard","it-l10n-ithemes-security-pro"),"aria-pressed":t,onClick:a,icon:"plus-alt",size:40})},renderContent:e=>{let{onClose:a}=e;return Object(s.createElement)(L,{dashboardId:t,close:a})}})))}var T=a("Td6G");function U(e){let{dashboardId:t}=e;const{dashboard:a}=Object(n.useSelect)(e=>({dashboard:e("ithemes-security/dashboard").getDashboard(t)}),[t]),r=Object(l.get)(a,["_embedded","author",0]);return!r||Object(T.j)(r)?null:Object(s.createElement)("div",{className:"itsec-admin-bar__share"},r&&!Object(T.j)(r)&&Object(s.createElement)("div",{className:"itsec-admin-bar-share__owner"},Object(s.createElement)(d.Tooltip,{text:r.name},Object(s.createElement)("span",{className:"itsec-admin-bar-share__recipient"},Object(s.createElement)("img",{className:"itsec-admin-bar-share__user-avatar",src:Object(b.getAvatarUrl)(r),alt:""})))))}var M=a("TSYQ"),B=a.n(M),P=a("FqII");var F=Object(h.compose)([Object(n.withSelect)((e,t)=>({currentDashboard:e("ithemes-security/dashboard").getViewingDashboardId(),isPrimary:e("ithemes-security/dashboard").getPrimaryDashboard()===t.dashboard.id,isDeleting:e("ithemes-security/dashboard").isDeletingDashboard(t.dashboard.id)})),Object(n.withDispatch)((e,t)=>({select:()=>e("ithemes-security/dashboard").viewDashboard(t.dashboard.id),setPrimary:()=>e("ithemes-security/dashboard").setPrimaryDashboard(t.dashboard.id),deleteDashboard:()=>e("ithemes-security/dashboard").deleteDashboard(t.dashboard.id)}))])((function(e){let{dashboard:t,currentDashboard:a,isPrimary:r,isDeleting:n,currentUserId:o,setPrimary:b,select:h,deleteDashboard:u,close:m}=e;const O=Object(i.decodeEntities)(t.label.rendered);return Object(s.createElement)("li",{className:B()("itsec-manage-dashboards__dashboard",{"itsec-manage-dashboard__dashboard--deleting":n})},Object(s.createElement)("header",{className:"itsec-manage-dashboards__dashboard-header"},Object(s.createElement)("h4",null,a===t.id?O:Object(s.createElement)(d.Button,{isLink:!0,onClick:()=>[h(t.id),m()]},O),r&&Object(s.createElement)("span",{className:"itsec-manage-dashboards__primary"},Object(c.__)("Primary","it-l10n-ithemes-security-pro"))),o!==t.created_by&&Object(s.createElement)("span",{className:"itsec-manage-dashboards__dashboard-meta itsec-manage-dashboards__dashboard-meta--author"},Object(c.sprintf)(Object(c.__)("Shared by %s","it-l10n-ithemes-security-pro"),Object(l.get)(t,["_embedded","author",0,"name"],Object(c.sprintf)(Object(c.__)("User #%d","it-l10n-ithemes-security-pro"),t.created_by)))),Object(s.createElement)("span",{className:"itsec-manage-dashboards__dashboard-meta itsec-manage-dashboards__dashboard-meta--date"},Object(c.sprintf)(Object(c.__)("Created on %s","it-l10n-ithemes-security-pro"),Object(P.dateI18n)("M j, Y",t.created_at)))),Object(s.createElement)("div",{className:"itsec-manage-dashboards__dashboard-actions"},!r&&Object(s.createElement)(d.Button,{isLink:!0,onClick:b,className:"itsec-manage-dashboards__dashboard-action"},Object(c.__)("Make Primary","it-l10n-ithemes-security-pro")),t.id!==a&&!r&&o===t.created_by&&Object(s.createElement)(d.Button,{isLink:!0,isDestructive:!0,onClick:u,className:"itsec-manage-dashboards__dashboard-action"},Object(c.__)("Delete","it-l10n-ithemes-security-pro"))))}));a("Yd+m");function A(e){let{close:t}=e;const{currentUserId:a,canCreate:r,dashboards:i}=Object(n.useSelect)(e=>{var t;return{canCreate:e("ithemes-security/dashboard").canCreateDashboards(),dashboards:e("ithemes-security/dashboard").getAvailableDashboards(),currentUserId:(null===(t=e("ithemes-security/core").getCurrentUser())||void 0===t?void 0:t.id)||0}},[]),{viewCreateDashboard:o}=Object(n.useDispatch)("ithemes-security/dashboard");return Object(s.createElement)("div",{className:"itsec-manage-dashboards"},Object(s.createElement)("header",{className:"itsec-manage-dashboards__header"},Object(s.createElement)("h3",null,Object(c.__)("Manage Dashboards","it-l10n-ithemes-security-pro")),Object(s.createElement)("p",null,Object(c.__)("Switch, manage, or create new dashboards.","it-l10n-ithemes-security-pro"))),Object(s.createElement)("ul",{className:"itsec-manage-dashboards__list"},i.map(e=>Object(s.createElement)(F,{key:e.id,dashboard:e,currentUserId:a,close:t}))),r&&Object(s.createElement)("section",{className:"itsec-manage-dashboards__create"},Object(s.createElement)(d.Button,{isLink:!0,onClick:()=>[o(),t()]},Object(c.__)("Create New Dashboard","it-l10n-ithemes-security-pro"))))}a("nK1V");function R(){const{canEdit:e,canCreate:t,dashboards:a,dashboard:r,dashboardId:l}=Object(n.useSelect)(e=>{const t=e("ithemes-security/dashboard").getViewingDashboardId();return{dashboardId:t,canEdit:e("ithemes-security/dashboard").canEditDashboard(t),dashboard:e("ithemes-security/dashboard").getDashboard(t),canCreate:e("ithemes-security/dashboard").canCreateDashboards(),dashboards:e("ithemes-security/dashboard").getAvailableDashboards()}},[]),b=Object(s.createElement)("h1",null,r?Object(i.decodeEntities)(r.label.rendered):Object(c.__)("No Dashboard Selected","it-l10n-ithemes-security-pro"));return Object(s.createElement)(o.AdminBarFill,{type:"primary"},Object(s.createElement)("div",{className:"itsec-admin-bar__title"},!t&&a.length<=1&&l?b:Object(s.createElement)(d.Dropdown,{className:"itsec-admin-bar-manage-dashboards__trigger",contentClassName:"itsec-admin-bar-manage-dashboards__content",position:"bottom right",headerTitle:Object(c.__)("Manage Dashboards","it-l10n-ithemes-security-pro"),expandOnMobile:!0,focusOnMount:"container",renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return Object(s.createElement)(d.Button,{"aria-expanded":t,onClick:a,isSecondary:!0},b,Object(s.createElement)(d.Dashicon,{icon:t?"arrow-up-alt2":"arrow-down-alt2",size:15}))},renderContent:e=>{let{onClose:t}=e;return Object(s.createElement)(A,{dashboardId:l,close:t})}})),r&&(e?Object(s.createElement)(x,{dashboardId:l}):Object(s.createElement)(U,{dashboardId:l})))}a("XjeN");function q(){return Object(s.createElement)(React.Fragment,null,Object(s.createElement)(R,null))}a.p=window.itsecWebpackPublicPath,Object(c.setLocaleData)({"":{}},"it-l10n-ithemes-security-pro"),Object(r.registerPlugin)("itsec-pro-dashboard",{render:()=>Object(s.createElement)(q,null)})},XjeN:function(e,t,a){},YLtl:function(e,t){!function(){e.exports=this.lodash}()},"Yd+m":function(e,t,a){},cDcd:function(e,t){!function(){e.exports=this.React}()},cruf:function(e,t){!function(){e.exports=this.itsec.dashboard.api}()},faye:function(e,t){!function(){e.exports=this.ReactDOM}()},gf1k:function(e,t){!function(){e.exports=this.itsec.dashboard.dashboard}()},l3Sj:function(e,t){!function(){e.exports=this.wp.i18n}()},nK1V:function(e,t,a){},oSrf:function(e,t,a){var s=a("y84Q");e.exports=function(e){var t=s(e);return Math.round((299*parseInt(t[0])+587*parseInt(t[1])+114*parseInt(t[2]))/1e3)<=180?"dark":"light"}},pyQa:function(e,t,a){},rl8x:function(e,t){!function(){e.exports=this.wp.isShallowEqual}()},rmEH:function(e,t){!function(){e.exports=this.wp.htmlEntities}()},"tI+e":function(e,t){!function(){e.exports=this.wp.components}()},y84Q:function(e,t){e.exports=function(e){e.charAt&&"#"===e.charAt(0)&&(e=function(e){var t=e.split("");return t.shift(),t.join("")}(e)),3===e.length&&(e=function(e){return e.split("").reduce((function(e,t){return e.concat([t,t])}),[]).join("")}(e));var t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]}},ywyh:function(e,t){!function(){e.exports=this.wp.apiFetch}()},z1rk:function(e,t){!function(){e.exports=this.itsec.packages.data}()}},[["Wv0H",0,4,1,2,3,7]]]);